{% extends "base.html" %}

{% block content %}
<h2>Task Progress: {{ task.title }}</h2>
<p><strong>Description:</strong> {{ task.description }}</p>
<p><strong>Deadline:</strong> {{ task.deadline.strftime('%Y-%m-%d %H:%M') }}</p>
<p><strong>Priority:</strong> {{ task.priority.replace('_', ' ').title() }}</p>

<h3>Assignments</h3>
{% if assignments %}
<table class="table">
    <thead>
        <tr>
            <th>Student</th>
            <th>Status</th>
            <th>Assigned At</th>
            <th>Submitted At</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for assignment in assignments %}
        <tr>
            <td>{{ assignment.student.name }}</td>
            <td>
                <span class="badge
                    {% if assignment.status == 'pending' %}bg-secondary
                    {% elif assignment.status == 'in_progress' %}bg-primary
                    {% elif assignment.status == 'completed' %}bg-success
                    {% else %}bg-danger{% endif %}">
                    {{ assignment.status.replace('_', ' ').title() }}
                </span>
            </td>
            <td>{{ assignment.assigned_at.strftime('%Y-%m-%d %H:%M') }}</td>
            <td>{{ assignment.submitted_at.strftime('%Y-%m-%d %H:%M') if assignment.submitted_at else 'Not submitted' }}</td>
            <td>
                {% if assignment.status == 'completed' %}
                <a href="{{ url_for('teacher.view_submission', assignment_id=assignment.id) }}" class="btn btn-sm btn-info">View Submission</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No students assigned to this task yet.</p>
{% endif %}

<a href="{{ url_for('teacher.dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
{% endblock %}